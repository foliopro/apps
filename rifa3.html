<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boleta Generada - Gran Rifa</title>
<style>
  body {
    background-color: #0b1020;
    color: white;
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    margin: 0;
    padding: 20px;
  }

  canvas {
    max-width: 95%;
    height: auto;
    margin-top: 15px;
    border-radius: 10px;
    box-shadow: 0 0 12px rgba(0,0,0,0.4);
  }

  /* Modal inferior */
  #modal {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(10, 15, 30, 0.95);
    padding: 15px;
    border-top: 2px solid #1e4db7;
    color: white;
    text-align: center;
    box-shadow: 0 -4px 10px rgba(0,0,0,0.4);
    display: none;
    animation: slideUp 0.4s ease;
  }

  @keyframes slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
  }

  #modal button {
    padding: 8px 14px;
    border-radius: 8px;
    border: none;
    margin: 5px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s;
  }

  #downloadBtn { background: #1e4db7; color: #fff; }
  #whatsBtn { background: #00a884; color: #fff; }
  #cancelBtn { background: #666; color: #fff; }

  #modal button:hover {
    filter: brightness(1.2);
  }
</style>
</head>
<body>
  <h2>Vista Previa de la Boleta</h2>
  <canvas id="boletaCanvas" width="720" height="360"></canvas>

  <div id="modal">
    <p>Â¿QuÃ© deseas hacer con esta boleta?</p>
    <button id="downloadBtn">Descargar</button>
    <button id="whatsBtn">Enviar por WhatsApp</button>
    <button id="cancelBtn">Cancelar</button>
  </div>

<script>
const canvas = document.getElementById("boletaCanvas");
const ctx = canvas.getContext("2d");
const modal = document.getElementById("modal");

const numero = localStorage.getItem("numero") || "000";
const nombre = localStorage.getItem("nombre") || "----";
const celular = localStorage.getItem("celular") || "";

const colorTexto = "rgba(1, 37, 87, 1)";

const img = new Image();
img.crossOrigin = "anonymous";
img.src = "https://i.ibb.co/n41YgFz/Whats-App-Image-2025-11-06-at-11-11-02-PM.jpg";

img.onload = () => {
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  ctx.fillStyle = colorTexto;
  ctx.textAlign = "left";

  // NÃºmero
  ctx.font = "bold 38px 'Segoe UI'";
  ctx.fillText(numero, 95, 105);

  // Nombre
  ctx.font = "bold 24px 'Segoe UI'";
  ctx.fillText(nombre.toUpperCase(), 180, 155);

  // Celular
  ctx.font = "bold 24px 'Segoe UI'";
  ctx.fillText(celular, 180, 190);

  // PagÃ³ (X)
  ctx.font = "bold 28px 'Segoe UI'";
  ctx.fillText("X", 130, 245);

  modal.style.display = "block";
};

// Descargar imagen
document.getElementById("downloadBtn").onclick = () => {
  const link = document.createElement("a");
  link.download = `Boleta_${numero}.png`;
  link.href = canvas.toDataURL("image/png");
  link.click();
  modal.style.display = "none";
};

// Enviar por WhatsApp
document.getElementById("whatsBtn").onclick = () => {
  const telefono = celular.replace(/\D/g, "");
  const mensaje = encodeURIComponent("Esta es tu boleta. Gracias por su apoyo ðŸŽ‰");
  window.open(`https://wa.me/57${telefono}?text=${mensaje}`, "_blank");
  modal.style.display = "none";
};

// Cancelar
document.getElementById("cancelBtn").onclick = () => {
  modal.style.display = "none";
};
</script>
</body>
</html>
